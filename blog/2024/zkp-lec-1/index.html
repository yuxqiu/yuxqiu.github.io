<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Non-Interactivity and Graph Non-Isomorphisim | Yuxiang Qiu </title> <meta name="author" content="Yuxiang Qiu"> <meta name="description" content="Yuxiang Qiu"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="/assets/fonts/google_fonts/google-fonts.css?dbb2a66cded10d969147626a2855d8a0"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://yuxqiu.github.io/blog/2024/zkp-lec-1/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Yuxiang Qiu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <svg id="light-toggle-system" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9.173 14.83a4 4 0 1 1 5.657 -5.657"></path><path d="M11.294 12.707l.174 .247a7.5 7.5 0 0 0 8.845 2.492a9 9 0 0 1 -14.671 2.914"></path><path d="M3 12h1"></path><path d="M12 3v1"></path><path d="M5.6 5.6l.7 .7"></path><path d="M3 21l18 -18"></path></svg> <svg id="light-toggle-dark" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="currentColor"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 1.992a10 10 0 1 0 9.236 13.838c.341 -.82 -.476 -1.644 -1.298 -1.31a6.5 6.5 0 0 1 -6.864 -10.787l.077 -.08c.551 -.63 .113 -1.653 -.758 -1.653h-.266l-.068 -.006l-.06 -.002z"></path></svg> <svg id="light-toggle-light" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="currentColor"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 19a1 1 0 0 1 .993 .883l.007 .117v1a1 1 0 0 1 -1.993 .117l-.007 -.117v-1a1 1 0 0 1 1 -1z"></path><path d="M18.313 16.91l.094 .083l.7 .7a1 1 0 0 1 -1.32 1.497l-.094 -.083l-.7 -.7a1 1 0 0 1 1.218 -1.567l.102 .07z"></path><path d="M7.007 16.993a1 1 0 0 1 .083 1.32l-.083 .094l-.7 .7a1 1 0 0 1 -1.497 -1.32l.083 -.094l.7 -.7a1 1 0 0 1 1.414 0z"></path><path d="M4 11a1 1 0 0 1 .117 1.993l-.117 .007h-1a1 1 0 0 1 -.117 -1.993l.117 -.007h1z"></path><path d="M21 11a1 1 0 0 1 .117 1.993l-.117 .007h-1a1 1 0 0 1 -.117 -1.993l.117 -.007h1z"></path><path d="M6.213 4.81l.094 .083l.7 .7a1 1 0 0 1 -1.32 1.497l-.094 -.083l-.7 -.7a1 1 0 0 1 1.217 -1.567l.102 .07z"></path><path d="M19.107 4.893a1 1 0 0 1 .083 1.32l-.083 .094l-.7 .7a1 1 0 0 1 -1.497 -1.32l.083 -.094l.7 -.7a1 1 0 0 1 1.414 0z"></path><path d="M12 2a1 1 0 0 1 .993 .883l.007 .117v1a1 1 0 0 1 -1.993 .117l-.007 -.117v-1a1 1 0 0 1 1 -1z"></path><path d="M12 7a5 5 0 1 1 -4.995 5.217l-.005 -.217l.005 -.217a5 5 0 0 1 4.995 -4.783z"></path></svg> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Non-Interactivity and Graph Non-Isomorphisim</h1> <p class="post-meta"> Created in September 10, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> 2024 </a>   ·   <a href="/blog/tag/zkp"> # ZKP</a>   <a href="/blog/tag/applied-cryptography"> # Applied Cryptography</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"> <a href="#not-all-interactive-protocols-can-be-converted-to-non-interactive-protocols">Not all interactive protocols can be converted to non-interactive protocols</a> <ul> <li class="toc-entry toc-h3"><a href="#schnorrs-protocol">Schnorr’s Protocol</a></li> <li class="toc-entry toc-h3"><a href="#what-prevents-grinding">What prevents grinding?</a></li> <li class="toc-entry toc-h3"><a href="#why-not-all-interactive-protocols-can-be-converted-to-non-interactive-protocols-via-arthur-merlin-game">Why not all interactive protocols can be converted to non-interactive protocols (via Arthur-Merlin Game)?</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#graph-non-isomorphism">Graph Non-Isomorphism</a> <ul> <li class="toc-entry toc-h3"><a href="#solution-1">Solution 1</a></li> <li class="toc-entry toc-h3"><a href="#solution-2">Solution 2</a></li> <li class="toc-entry toc-h3"><a href="#last-solution">Last Solution</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <p>This is a supplement to <a href="https://www.youtube.com/watch?v=uchjTIlPzFo" rel="external nofollow noopener" target="_blank">Zero Knowledge Proofs - Lecture 1</a>.</p> <h2 id="not-all-interactive-protocols-can-be-converted-to-non-interactive-protocols">Not all interactive protocols can be converted to non-interactive protocols</h2> <p>In the lecture, the professor claimed that not all interactive protocols can be converted to non-interactive protocols, and the reason given in the <a href="https://zk-learning.org/assets/Lecture1-2023-slides.pdf?slide=72" rel="external nofollow noopener" target="_blank">slide</a> was that IP = AM sometimes requires a super-polynomial prover, and in the case of Fiat-Shamir transformation, the prover needs to be computationally bounded, and therefore cannot invert H.</p> <p>However, why is this the case? Let’s use Schnorr’s Protocol as a case study to explain it.</p> <h3 id="schnorrs-protocol">Schnorr’s Protocol</h3> <p>Goal: Prover convinces Verifier that they know $x$ such that $h = g^x$ where $g$ is a generator of a group.</p> \[\newcommand{\work}[2]{#1 &amp; &amp; #2\\} \newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}} \newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}} \newcommand{\alicework}[1]{#1 &amp; &amp;\\[-5pt]} \newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}} \newcommand{\varr}{\class{var var_r}{r}} \require{action} \newcommand{\sampleSymb}{ {\; \xleftarrow{$} \;} } \newcommand{\zqs}{\mathbb{Z}_q^\ast} \newcommand{\varu}{\class{var var_u}{u}} \newcommand{\varg}{\class{var var_g}{g}} \newcommand{\alicebob}[3]{#1 &amp; \ra{#2} &amp; #3\\[-5pt]} \newcommand{\ra}[1]{\vphantom{}\smash{\xrightarrow{\hspace{1cm}#1\hspace{1cm}}}} \newcommand{\bobwork}[1]{ &amp; &amp; #1\\[-5pt]} \newcommand{\schnorrvalidate}{\mathsf{schnorr}\_\mathsf{validate}} \newcommand{\varh}{\class{var var_h}{h}} \newcommand{\bobseparator}{&amp;&amp;-------\\} \newcommand{\sample}[1]{#1\sampleSymb\zq} \newcommand{\varc}{\class{var var_c}{c}} \newcommand{\bobalice}[3]{#1 &amp; \la{#2} &amp; #3\\[-5pt]} \newcommand{\la}[1]{\vphantom{}\smash{\xleftarrow{\hspace{1cm}#1\hspace{1cm}}}} \newcommand{\varx}{\class{var var_x}{x}} \newcommand{\varz}{\class{var var_z}{z}} \newcommand{\equalQ}{\overset{?}{=}} \newcommand{\zq}{\mathbb{Z}_\varq} \newcommand{\varq}{\class{var var_q}{q}} \begin{array}{c} \work{\varprover}{\varverifier} \alicework{\samplezqs{\varr}} \alicework{\varu = \varg^\varr} \alicebob{}{\varu}{} \bobwork{\sample{\varc}} \bobalice{}{\varc}{} \alicework{\varz = \varr + \varx\cdot \varc} \alicebob{}{\varz}{} \bobwork{\varg^{\varz} \equalQ \varu \cdot \varh^\varc } \end{array}\] <ul> <li>Thanks <a href="https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/" rel="external nofollow noopener" target="_blank">ZKDocs - Schnorr’s identification protocol</a> and <a href="https://crypto.stanford.edu/cs355/19sp/lec5.pdf" rel="external nofollow noopener" target="_blank">Lecture 5: Proofs of Knowledge, Schnorr’s protocol, NIZK</a> for providing the code and the graph.</li> </ul> <p>The completeness of the above protocol is easy to see. For soundness, instead of proving statistical soundness, we can prove <a href="https://crypto.stanford.edu/cs355/19sp/lec5.pdf?slide=3" rel="external nofollow noopener" target="_blank">special soundness</a>.</p> <p>Just a sidenote, to convert this Schnorr’s Protocol to an non-interactive version, <a href="https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/#what-can-go-wrong" rel="external nofollow noopener" target="_blank">ZKDocs</a> provides a case where incorrect input is used in Fiat-Shamir transformation, which causes the protocol to be insecure. It’s worth noting that the case they discussed is a bit different from what I have shown above. It’s about generating a valid triple ($X=g^x \pmod q$, $c = \text{Hash(input)}$, $z$) for any X of prover’s choice <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>, which means there is no fixed $X$ shared by both parties at the beginning. If you are interested, feel free to read the linked article and the paper.</p> <h3 id="what-prevents-grinding">What prevents grinding?</h3> <p>Now, let’s get back to the protocol that I described above. Suppose we want to turn it into an non-interactive version. The obvious thing we can do is to let $c = \text{Hash(u)}$ and then use it to generate $z = r + x * c$.</p> <p>Now, you might be thinking: what prevents a malicious prover from grinding? In other words, since the variable $c$ is just a coin <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>, the malicious prover can just sampled 2 $r$ and it’s very likely that one of the $\text{Hash(u)} = \text{Hash(g^r)}$ it gets is $0$, which means it can then return $z = r$ directly. From the perspective of the verifier, this is a correct proof.</p> <p>The answer to that problem is also very simple: c is not a coin, but a random value drawn from a field. If this is the case, the challenge space $C$ (the field where the “coin” c is chosen from) will be pretty large. As a result, the probability of finding the collision that I described above will be $\frac{1}{|C|}$ <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>.</p> <ul> <li>If you treat $c$ as a $c$-bit number, then the probability will be $\frac{1}{|2^c|}$.</li> </ul> <h3 id="why-not-all-interactive-protocols-can-be-converted-to-non-interactive-protocols-via-arthur-merlin-game">Why not all interactive protocols can be converted to non-interactive protocols (via Arthur-Merlin Game)?</h3> <p>By the analysis above, we know that the probability of successfully grinding is $\frac{1}{2^c}$. If the prover is computationally bounded, this is fine. However, if it’s not the case, we are in trouble.</p> <p>This is exactly why not all interactive protocols can be converted to non-interactive protocols as IP = AM transformation sometimes requires extra <strong>super-polynomial</strong> powers from Merlin (the prover).</p> <h2 id="graph-non-isomorphism">Graph Non-Isomorphism</h2> <p>In the lecture, the professor shows an interactive proof of graph non-isomorphism. However, this proof is not ZK because <strong>a malicious verifier</strong> can use a completely new graph (not derived from either G0 or G1) and ask prover to show whether it is isomorphism to G0 or G1. Therefore, it can obtain extra information that cannot be simulated.</p> <p>The way to solve this problem is briefly discussed: the verifier first prove to the prover that the graph it sends (let’s call it G) is indeed isomorphic to one of the G0 and G1 (can be both).</p> <ul> <li>But it is indeed very tricky to do so if you think about this carefully. How can you prove this without revealing which graph is isomorphic to G?</li> </ul> <p>The remaining part of this article will analyze <a href="https://pinkpurplepineapples.wordpress.com/2019/07/24/zero-knowledge-proofs-graph-isomorphism/" rel="external nofollow noopener" target="_blank">this amazing blog</a> to see how we can prove this in a PZK (perfect zero knowledge) way.</p> <h3 id="solution-1">Solution 1</h3> <blockquote> <p>Send the two graphs $\pi_0(G_0), \pi_1(G_1)$. The verifier then sends back an integer, pointing to one of these two graphs, and the prover responds by providing the permutation from G to this graph. Note that if at least one of the graphs is isomorphic to G, the prover can do so with at least probability 1/2.</p> </blockquote> <p>This does not work because a simulator $S$, given access to verifier $V$, cannot simulate this because</p> <ul> <li>It runs in PPT (probabilistic polynomial time), so it cannot using $\pi_0(G_0), \pi_1(G_1)$ (where $\pi_0, \pi_1$ are random permutations), generating a random number $r$, checking if it is able to find a permutation between $G_r$ and $G$.</li> <li>At the same time, it does not know which graph $G$ is isomorphic to, so it pre-prepare a permutation $\pi$ and generate messages like $\pi(G), \pi_1(G_1)$ and $\pi_0(G_0), \pi(G)$.</li> </ul> <h3 id="solution-2">Solution 2</h3> <p>The prover sends back $\pi(G), \pi_0(G_0), \pi_1(G_1)$ in a random order. The verifier then randomly points to one of the three graphs, and asks the prover to show that this graph is isomorphic to G.</p> <p>For the same reason, this method doesn’t work either. Given the length of the article, I’ll skip to the last solution.</p> <h3 id="last-solution">Last Solution</h3> <p>The last solution is a very interesting construction.</p> <blockquote> <ol> <li>Prover responds by sending two scrambled and permuted ordered copies of G, G_0, G_1 to the Verifier, with an additional restriction that second scrambling of the three graphs is either a right shift, or a left shift of the original three graphs. <ul> <li>In other words, it sends: <ul> <li>$\pi(H), \pi_0(H_0), \pi_1(H_1)$</li> <li>$\pi_0’(H_0), \pi_1’(H_1), \pi’(H)$</li> </ul> </li> </ul> <ul> <li>or: <ul> <li>$\pi(H), \pi_0(H_0), \pi_1(H_1)$</li> <li>$\pi_1’(H_1), \pi’(H), \pi_0’(H_0)$</li> </ul> </li> <li>where $H, H_0, H_1$ is some random permutation (<strong>ordering</strong>) of $G, G_0, G_1$</li> </ul> </li> <li>The Verifier now responds with either a 0, or a 1, one option to continue with the proof, and the other to verify that the two permuted copies indeed satisfy the requirements.</li> <li>If the Verifier sent a 0, the Prover reveals the two permutations, and we go back to step 2. If the Verifier sent a 1, we continue to prove that at least one of the graphs is isomorphic to G, by choosing one of the columns, and showing that both of the graphs in that column are isomorphic to G by sending back the permutations.</li> </ol> </blockquote> <p>This solution works and achieve PZK because:</p> <ul> <li>H0, H1, H2 is a permutation of G0, G1, G2 (they are G0, G1, G2 in random order) -&gt; this ensures that the correct column that the prover will pick can be any of the three columns. <ul> <li>Suppose no permutation is used, and only left and right shifts are used. Then, the probability of a column being selected is 1:1:0 (G isomorphic to G0) or 1:0:1 (to G1) or 1:1:1 (to G0 and G1) depending on which graph G is isomorphic to. <ul> <li>Isomorphic to G0 <ul> <li> <strong>G</strong>, G0, G1</li> <li> <strong>G0</strong>, G1, G</li> <li> <hr> </li> <li>G, <strong>G0</strong>, G1</li> <li>G1, <strong>G</strong>, G0</li> </ul> </li> <li>Isomorphic to G1 <ul> <li>G, G0, <strong>G1</strong> </li> <li>G0, G1, <strong>G</strong> </li> <li> <hr> </li> <li> <strong>G</strong>, G0, G1</li> <li> <strong>G1</strong>, G, G0</li> </ul> </li> <li>So, without permutation, we can know some additional information based on which column is selected.</li> </ul> </li> </ul> </li> <li>Left Shift or Right Shift: it’s important to have them as well. This ensures that no matter the permutation, the distance between the G and G0/G1 (the graph G is isomorphic to) is always 1. If the distance is not always the same, after randomly selecting the column in the simulator, we cannot construct the other two columns randomly because we must fix the position of the graph that G is isomorphic to match distance = 1. <ul> <li>For example, given this permuatation Gx, G, Gy. Suppose G1 is isomorphic to G. If we only allow left shift, we can only choose Gy as the position for G1. <ul> <li>But, in reality, the simulator doesn’t know which graph G is isomorphic to.</li> <li>So, after selecting the column randomly, it cannot proceed.</li> </ul> </li> </ul> </li> </ul> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p><a href="https://eprint.iacr.org/2016/771.pdf#page=6" rel="external nofollow noopener" target="_blank">https://eprint.iacr.org/2016/771.pdf#page=6</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:2" role="doc-endnote"> <p>This is not true, but a misconception that I had after listening to lecture 1. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:3" role="doc-endnote"> <p><a href="https://crypto.stackexchange.com/questions/97735/grinding-in-the-fiat-shamir-heuristic" rel="external nofollow noopener" target="_blank">https://crypto.stackexchange.com/questions/97735/grinding-in-the-fiat-shamir-heuristic</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </div> </article> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?fd05ad563fc46d96dfe9e0820bab4b75" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams",inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> </body> </html>