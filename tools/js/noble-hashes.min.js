"use strict";var nobleHashes=(()=>{var Ce=Object.defineProperty;var Gn=Object.getOwnPropertyDescriptor;var Rn=Object.getOwnPropertyNames;var Xn=Object.prototype.hasOwnProperty;var Vn=(e,t)=>{for(var s in t)Ce(e,s,{get:t[s],enumerable:!0})},jn=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Rn(t))!Xn.call(e,o)&&o!==s&&Ce(e,o,{get:()=>t[o],enumerable:!(r=Gn(t,o))||r.enumerable});return e};var Kn=e=>jn(Ce({},"__esModule",{value:!0}),e);var Xr={};Vn(Xr,{argon2id:()=>Es,blake224:()=>Os,blake256:()=>Ds,blake2b:()=>_t,blake2s:()=>Is,blake3:()=>Ms,blake384:()=>Cs,blake512:()=>Ts,cshake128:()=>Un,cshake256:()=>En,eskdf:()=>Zs,hkdf:()=>Ie,hmac:()=>Dt,k12:()=>Mn,keccak_224:()=>yn,keccak_256:()=>kn,keccak_384:()=>mn,keccak_512:()=>wn,keccakprg:()=>Nn,kmac128:()=>On,kmac256:()=>Dn,m14:()=>Pn,md5:()=>tn,pbkdf2:()=>Yt,pbkdf2Async:()=>Rs,ripemd160:()=>hn,scrypt:()=>_e,scryptAsync:()=>Js,sha1:()=>Qs,sha224:()=>Qe,sha256:()=>qt,sha384:()=>js,sha3_224:()=>pn,sha3_256:()=>xn,sha3_384:()=>bn,sha3_512:()=>gn,sha512:()=>Vs,sha512_224:()=>zs,sha512_256:()=>Ks,shake128:()=>Bn,shake256:()=>Ln,turboshake128:()=>Tn,turboshake256:()=>Fn,utils:()=>Rr});var Kt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function zn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function D(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function U(e,...t){if(!zn(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function zt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");D(e.outputLen),D(e.blockLen)}function z(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ut(e,t){U(e);let s=t.outputLen;if(e.length<s)throw new Error("digestInto() expects output buffer of length at least "+s)}function Ht(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function F(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function L(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function nt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Z(e,t){return e<<32-t|e>>>t}function H(e,t){return e<<t|e>>>32-t>>>0}var ls=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function fs(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}var rt=ls?e=>e:e=>fs(e);function Wn(e){for(let t=0;t<e.length;t++)e[t]=fs(e[t]);return e}var C=ls?e=>e:Wn,us=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Yn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function fe(e){if(U(e),us)return e.toHex();let t="";for(let s=0;s<e.length;s++)t+=Yn[e[s]];return t}var kt={_0:48,_9:57,A:65,F:70,a:97,f:102};function as(e){if(e>=kt._0&&e<=kt._9)return e-kt._0;if(e>=kt.A&&e<=kt.F)return e-(kt.A-10);if(e>=kt.a&&e<=kt.f)return e-(kt.a-10)}function ue(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(us)return Uint8Array.fromHex(e);let t=e.length,s=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(s);for(let o=0,n=0;o<s;o++,n+=2){let i=as(e.charCodeAt(n)),h=as(e.charCodeAt(n+1));if(i===void 0||h===void 0){let c=e[n]+e[n+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+n)}r[o]=i*16+h}return r}var ds=async()=>{};async function re(e,t,s){let r=Date.now();for(let o=0;o<e;o++){s(o);let n=Date.now()-r;n>=0&&n<t||(await ds(),r+=n)}}function de(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function E(e){return typeof e=="string"&&(e=de(e)),U(e),e}function dt(e){return typeof e=="string"&&(e=de(e)),U(e),e}function ps(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];U(o),t+=o.length}let s=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let n=e[r];s.set(n,o),o+=n.length}return s}function pe(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var it=class{};function ot(e){let t=r=>e().update(E(r)).digest(),s=e();return t.outputLen=s.outputLen,t.blockLen=s.blockLen,t.create=()=>e(),t}function ct(e){let t=(r,o)=>e(o).update(E(r)).digest(),s=e({});return t.outputLen=s.outputLen,t.blockLen=s.blockLen,t.create=r=>e(r),t}function Wt(e){let t=(r,o)=>e(o).update(E(r)).digest(),s=e({});return t.outputLen=s.outputLen,t.blockLen=s.blockLen,t.create=r=>e(r),t}function xs(e=32){if(Kt&&typeof Kt.getRandomValues=="function")return Kt.getRandomValues(new Uint8Array(e));if(Kt&&typeof Kt.randomBytes=="function")return Uint8Array.from(Kt.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}var xe=BigInt(4294967295),bs=BigInt(32);function pt(e,t=!1){return t?{h:Number(e&xe),l:Number(e>>bs&xe)}:{h:Number(e>>bs&xe)|0,l:Number(e&xe)|0}}function be(e,t=!1){let s=e.length,r=new Uint32Array(s),o=new Uint32Array(s);for(let n=0;n<s;n++){let{h:i,l:h}=pt(e[n],t);[r[n],o[n]]=[i,h]}return[r,o]}var Te=(e,t,s)=>e>>>s,Fe=(e,t,s)=>e<<32-s|t>>>s,W=(e,t,s)=>e>>>s|t<<32-s,Y=(e,t,s)=>e<<32-s|t>>>s,mt=(e,t,s)=>e<<64-s|t>>>s-32,wt=(e,t,s)=>e>>>s-32|t<<64-s,Jt=(e,t)=>t,Zt=(e,t)=>e,gs=(e,t,s)=>e<<s|t>>>32-s,ys=(e,t,s)=>t<<s|e>>>32-s,ks=(e,t,s)=>t<<s-32|e>>>64-s,ms=(e,t,s)=>e<<s-32|t>>>64-s;function $(e,t,s,r){let o=(t>>>0)+(r>>>0);return{h:e+s+(o/2**32|0)|0,l:o|0}}var xt=(e,t,s)=>(e>>>0)+(t>>>0)+(s>>>0),bt=(e,t,s,r)=>t+s+r+(e/2**32|0)|0,ws=(e,t,s,r)=>(e>>>0)+(t>>>0)+(s>>>0)+(r>>>0),As=(e,t,s,r,o)=>t+s+r+o+(e/2**32|0)|0,Bs=(e,t,s,r,o)=>(e>>>0)+(t>>>0)+(s>>>0)+(r>>>0)+(o>>>0),Ls=(e,t,s,r,o,n)=>t+s+r+o+n+(e/2**32|0)|0;var S=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function R(e,t,s,r,o){return e=e+t+o|0,r=Z(r^e,16),s=s+r|0,t=Z(t^s,12),{a:e,b:t,c:s,d:r}}function X(e,t,s,r,o){return e=e+t+o|0,r=Z(r^e,8),s=s+r|0,t=Z(t^s,7),{a:e,b:t,c:s,d:r}}function Pe(e,t,s,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,s,r);let o=BigInt(32),n=BigInt(4294967295),i=Number(s>>o&n),h=Number(s&n),c=r?4:0,a=r?0:4;e.setUint32(t+c,i,r),e.setUint32(t+a,h,r)}function $t(e,t,s){return e&t^~e&s}function ge(e,t,s){return e&t^e&s^t&s}var At=class extends it{constructor(t,s,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=s,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=nt(this.buffer)}update(t){z(this),t=E(t),U(t);let{view:s,buffer:r,blockLen:o}=this,n=t.length;for(let i=0;i<n;){let h=Math.min(o-this.pos,n-i);if(h===o){let c=nt(t);for(;o<=n-i;i+=o)this.process(c,i);continue}r.set(t.subarray(i,i+h),this.pos),this.pos+=h,i+=h,this.pos===o&&(this.process(s,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){z(this),ut(t,this),this.finished=!0;let{buffer:s,view:r,blockLen:o,isLE:n}=this,{pos:i}=this;s[i++]=128,L(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)s[l]=0;Pe(r,o-8,BigInt(this.length*8),n),this.process(r,0);let h=nt(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=c/4,f=this.get();if(a>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)h.setUint32(4*l,f[l],n)}digest(){let{buffer:t,outputLen:s}=this;this.digestInto(t);let r=t.slice(0,s);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:s,buffer:r,length:o,finished:n,destroyed:i,pos:h}=this;return t.destroyed=i,t.finished=n,t.length=o,t.pos=h,o%s&&t.buffer.set(r),t}clone(){return this._cloneInto()}},st=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),at=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),P=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),N=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var G=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),k=new Uint32Array(32);function It(e,t,s,r,o,n){let i=o[n],h=o[n+1],c=k[2*e],a=k[2*e+1],f=k[2*t],l=k[2*t+1],u=k[2*s],p=k[2*s+1],x=k[2*r],d=k[2*r+1],b=xt(c,f,i);a=bt(b,a,l,h),c=b|0,{Dh:d,Dl:x}={Dh:d^a,Dl:x^c},{Dh:d,Dl:x}={Dh:Jt(d,x),Dl:Zt(d,x)},{h:p,l:u}=$(p,u,d,x),{Bh:l,Bl:f}={Bh:l^p,Bl:f^u},{Bh:l,Bl:f}={Bh:W(l,f,24),Bl:Y(l,f,24)},k[2*e]=c,k[2*e+1]=a,k[2*t]=f,k[2*t+1]=l,k[2*s]=u,k[2*s+1]=p,k[2*r]=x,k[2*r+1]=d}function vt(e,t,s,r,o,n){let i=o[n],h=o[n+1],c=k[2*e],a=k[2*e+1],f=k[2*t],l=k[2*t+1],u=k[2*s],p=k[2*s+1],x=k[2*r],d=k[2*r+1],b=xt(c,f,i);a=bt(b,a,l,h),c=b|0,{Dh:d,Dl:x}={Dh:d^a,Dl:x^c},{Dh:d,Dl:x}={Dh:W(d,x,16),Dl:Y(d,x,16)},{h:p,l:u}=$(p,u,d,x),{Bh:l,Bl:f}={Bh:l^p,Bl:f^u},{Bh:l,Bl:f}={Bh:mt(l,f,63),Bl:wt(l,f,63)},k[2*e]=c,k[2*e+1]=a,k[2*t]=f,k[2*t+1]=l,k[2*s]=u,k[2*s+1]=p,k[2*r]=x,k[2*r+1]=d}function Hs(e,t={},s,r,o){if(D(s),e<0||e>s)throw new Error("outputLen bigger than keyLen");let{key:n,salt:i,personalization:h}=t;if(n!==void 0&&(n.length<1||n.length>s))throw new Error("key length must be undefined or 1.."+s);if(i!==void 0&&i.length!==r)throw new Error("salt must be undefined or "+r);if(h!==void 0&&h.length!==o)throw new Error("personalization must be undefined or "+o)}var Qt=class extends it{constructor(t,s){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,D(t),D(s),this.blockLen=t,this.outputLen=s,this.buffer=new Uint8Array(t),this.buffer32=F(this.buffer)}update(t){z(this),t=E(t),U(t);let{blockLen:s,buffer:r,buffer32:o}=this,n=t.length,i=t.byteOffset,h=t.buffer;for(let c=0;c<n;){this.pos===s&&(C(o),this.compress(o,0,!1),C(o),this.pos=0);let a=Math.min(s-this.pos,n-c),f=i+c;if(a===s&&!(f%4)&&c+a<n){let l=new Uint32Array(h,f,Math.floor((n-c)/4));C(l);for(let u=0;c+s<n;u+=o.length,c+=s)this.length+=s,this.compress(l,u,!1);C(l);continue}r.set(t.subarray(c,c+a),this.pos),this.pos+=a,this.length+=a,c+=a}return this}digestInto(t){z(this),ut(t,this);let{pos:s,buffer32:r}=this;this.finished=!0,L(this.buffer.subarray(s)),C(r),this.compress(r,0,!0),C(r);let o=F(t);this.get().forEach((n,i)=>o[i]=rt(n))}digest(){let{buffer:t,outputLen:s}=this;this.digestInto(t);let r=t.slice(0,s);return this.destroy(),r}_cloneInto(t){let{buffer:s,length:r,finished:o,destroyed:n,outputLen:i,pos:h}=this;return t||(t=new this.constructor({dkLen:i})),t.set(...this.get()),t.buffer.set(s),t.destroyed=n,t.finished=o,t.length=r,t.pos=h,t.outputLen=i,t}clone(){return this._cloneInto()}},Ne=class extends Qt{constructor(t={}){let s=t.dkLen===void 0?64:t.dkLen;super(128,s),this.v0l=G[0]|0,this.v0h=G[1]|0,this.v1l=G[2]|0,this.v1h=G[3]|0,this.v2l=G[4]|0,this.v2h=G[5]|0,this.v3l=G[6]|0,this.v3h=G[7]|0,this.v4l=G[8]|0,this.v4h=G[9]|0,this.v5l=G[10]|0,this.v5h=G[11]|0,this.v6l=G[12]|0,this.v6h=G[13]|0,this.v7l=G[14]|0,this.v7h=G[15]|0,Hs(s,t,64,16,16);let{key:r,personalization:o,salt:n}=t,i=0;if(r!==void 0&&(r=E(r),i=r.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,n!==void 0){n=E(n);let h=F(n);this.v4l^=rt(h[0]),this.v4h^=rt(h[1]),this.v5l^=rt(h[2]),this.v5h^=rt(h[3])}if(o!==void 0){o=E(o);let h=F(o);this.v6l^=rt(h[0]),this.v6h^=rt(h[1]),this.v7l^=rt(h[2]),this.v7h^=rt(h[3])}if(r!==void 0){let h=new Uint8Array(this.blockLen);h.set(r),this.update(h)}}get(){let{v0l:t,v0h:s,v1l:r,v1h:o,v2l:n,v2h:i,v3l:h,v3h:c,v4l:a,v4h:f,v5l:l,v5h:u,v6l:p,v6h:x,v7l:d,v7h:b}=this;return[t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b]}set(t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b){this.v0l=t|0,this.v0h=s|0,this.v1l=r|0,this.v1h=o|0,this.v2l=n|0,this.v2h=i|0,this.v3l=h|0,this.v3h=c|0,this.v4l=a|0,this.v4h=f|0,this.v5l=l|0,this.v5h=u|0,this.v6l=p|0,this.v6h=x|0,this.v7l=d|0,this.v7h=b|0}compress(t,s,r){this.get().forEach((c,a)=>k[a]=c),k.set(G,16);let{h:o,l:n}=pt(BigInt(this.length));k[24]=G[8]^n,k[25]=G[9]^o,r&&(k[28]=~k[28],k[29]=~k[29]);let i=0,h=S;for(let c=0;c<12;c++)It(0,4,8,12,t,s+2*h[i++]),vt(0,4,8,12,t,s+2*h[i++]),It(1,5,9,13,t,s+2*h[i++]),vt(1,5,9,13,t,s+2*h[i++]),It(2,6,10,14,t,s+2*h[i++]),vt(2,6,10,14,t,s+2*h[i++]),It(3,7,11,15,t,s+2*h[i++]),vt(3,7,11,15,t,s+2*h[i++]),It(0,5,10,15,t,s+2*h[i++]),vt(0,5,10,15,t,s+2*h[i++]),It(1,6,11,12,t,s+2*h[i++]),vt(1,6,11,12,t,s+2*h[i++]),It(2,7,8,13,t,s+2*h[i++]),vt(2,7,8,13,t,s+2*h[i++]),It(3,4,9,14,t,s+2*h[i++]),vt(3,4,9,14,t,s+2*h[i++]);this.v0l^=k[0]^k[16],this.v0h^=k[1]^k[17],this.v1l^=k[2]^k[18],this.v1h^=k[3]^k[19],this.v2l^=k[4]^k[20],this.v2h^=k[5]^k[21],this.v3l^=k[6]^k[22],this.v3h^=k[7]^k[23],this.v4l^=k[8]^k[24],this.v4h^=k[9]^k[25],this.v5l^=k[10]^k[26],this.v5h^=k[11]^k[27],this.v6l^=k[12]^k[28],this.v6h^=k[13]^k[29],this.v7l^=k[14]^k[30],this.v7h^=k[15]^k[31],L(k)}destroy(){this.destroyed=!0,L(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},_t=ct(e=>new Ne(e));function ye(e,t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b,g,A,m){let w=0;for(let B=0;B<r;B++)({a:o,b:c,c:u,d:b}=R(o,c,u,b,s[t+e[w++]])),{a:o,b:c,c:u,d:b}=X(o,c,u,b,s[t+e[w++]]),{a:n,b:a,c:p,d:g}=R(n,a,p,g,s[t+e[w++]]),{a:n,b:a,c:p,d:g}=X(n,a,p,g,s[t+e[w++]]),{a:i,b:f,c:x,d:A}=R(i,f,x,A,s[t+e[w++]]),{a:i,b:f,c:x,d:A}=X(i,f,x,A,s[t+e[w++]]),{a:h,b:l,c:d,d:m}=R(h,l,d,m,s[t+e[w++]]),{a:h,b:l,c:d,d:m}=X(h,l,d,m,s[t+e[w++]]),{a:o,b:a,c:x,d:m}=R(o,a,x,m,s[t+e[w++]]),{a:o,b:a,c:x,d:m}=X(o,a,x,m,s[t+e[w++]]),{a:n,b:f,c:d,d:b}=R(n,f,d,b,s[t+e[w++]]),{a:n,b:f,c:d,d:b}=X(n,f,d,b,s[t+e[w++]]),{a:i,b:l,c:u,d:g}=R(i,l,u,g,s[t+e[w++]]),{a:i,b:l,c:u,d:g}=X(i,l,u,g,s[t+e[w++]]),{a:h,b:c,c:p,d:A}=R(h,c,p,A,s[t+e[w++]]),{a:h,b:c,c:p,d:A}=X(h,c,p,A,s[t+e[w++]]);return{v0:o,v1:n,v2:i,v3:h,v4:c,v5:a,v6:f,v7:l,v8:u,v9:p,v10:x,v11:d,v12:b,v13:g,v14:A,v15:m}}var q=st,Ge=class extends Qt{constructor(t={}){let s=t.dkLen===void 0?32:t.dkLen;super(64,s),this.v0=q[0]|0,this.v1=q[1]|0,this.v2=q[2]|0,this.v3=q[3]|0,this.v4=q[4]|0,this.v5=q[5]|0,this.v6=q[6]|0,this.v7=q[7]|0,Hs(s,t,32,8,8);let{key:r,personalization:o,salt:n}=t,i=0;if(r!==void 0&&(r=E(r),i=r.length),this.v0^=this.outputLen|i<<8|65536|1<<24,n!==void 0){n=E(n);let h=F(n);this.v4^=rt(h[0]),this.v5^=rt(h[1])}if(o!==void 0){o=E(o);let h=F(o);this.v6^=rt(h[0]),this.v7^=rt(h[1])}if(r!==void 0){U(r);let h=new Uint8Array(this.blockLen);h.set(r),this.update(h)}}get(){let{v0:t,v1:s,v2:r,v3:o,v4:n,v5:i,v6:h,v7:c}=this;return[t,s,r,o,n,i,h,c]}set(t,s,r,o,n,i,h,c){this.v0=t|0,this.v1=s|0,this.v2=r|0,this.v3=o|0,this.v4=n|0,this.v5=i|0,this.v6=h|0,this.v7=c|0}compress(t,s,r){let{h:o,l:n}=pt(BigInt(this.length)),{v0:i,v1:h,v2:c,v3:a,v4:f,v5:l,v6:u,v7:p,v8:x,v9:d,v10:b,v11:g,v12:A,v13:m,v14:w,v15:B}=ye(S,s,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,q[0],q[1],q[2],q[3],n^q[4],o^q[5],r?~q[6]:q[6],q[7]);this.v0^=i^x,this.v1^=h^d,this.v2^=c^b,this.v3^=a^g,this.v4^=f^A,this.v5^=l^m,this.v6^=u^w,this.v7^=p^B}destroy(){this.destroyed=!0,L(this.buffer32),this.set(0,0,0,0,0,0,0,0)}},Is=ct(e=>new Ge(e));var me={Argond2d:0,Argon2i:1,Argon2id:2},oe=4,vs=e=>e===void 0?Uint8Array.of():dt(e);function Re(e,t){let s=e&65535,r=e>>>16,o=t&65535,n=t>>>16,i=Math.imul(s,o),h=Math.imul(r,o),c=Math.imul(s,n),a=Math.imul(r,n),f=(i>>>16)+(h&65535)+c,l=a+(h>>>16)+(f>>>16)|0,u=f<<16|i&65535;return{h:l,l:u}}function qn(e,t){let{h:s,l:r}=Re(e,t);return{h:(s<<1|r>>>31)&4294967295,l:r<<1&4294967295}}function ke(e,t,s,r){let{h:o,l:n}=qn(t,r),i=xt(t,r,n);return{h:bt(i,e,s,o),l:i|0}}var M=new Uint32Array(256);function Ut(e,t,s,r){let o=M[2*e],n=M[2*e+1],i=M[2*t],h=M[2*t+1],c=M[2*s],a=M[2*s+1],f=M[2*r],l=M[2*r+1];({h:n,l:o}=ke(n,o,h,i)),{Dh:l,Dl:f}={Dh:l^n,Dl:f^o},{Dh:l,Dl:f}={Dh:Jt(l,f),Dl:Zt(l,f)},{h:a,l:c}=ke(a,c,l,f),{Bh:h,Bl:i}={Bh:h^a,Bl:i^c},{Bh:h,Bl:i}={Bh:W(h,i,24),Bl:Y(h,i,24)},{h:n,l:o}=ke(n,o,h,i),{Dh:l,Dl:f}={Dh:l^n,Dl:f^o},{Dh:l,Dl:f}={Dh:W(l,f,16),Dl:Y(l,f,16)},{h:a,l:c}=ke(a,c,l,f),{Bh:h,Bl:i}={Bh:h^a,Bl:i^c},{Bh:h,Bl:i}={Bh:mt(h,i,63),Bl:wt(h,i,63)},M[2*e]=o,M[2*e+1]=n,M[2*t]=i,M[2*t+1]=h,M[2*s]=c,M[2*s+1]=a,M[2*r]=f,M[2*r+1]=l}function _s(e,t,s,r,o,n,i,h,c,a,f,l,u,p,x,d){Ut(e,o,c,u),Ut(t,n,a,p),Ut(s,i,f,x),Ut(r,h,l,d),Ut(e,n,f,d),Ut(t,i,l,u),Ut(s,h,c,p),Ut(r,o,a,x)}function ie(e,t,s,r,o){for(let n=0;n<256;n++)M[n]=e[t+n]^e[s+n];for(let n=0;n<128;n+=16)_s(n,n+1,n+2,n+3,n+4,n+5,n+6,n+7,n+8,n+9,n+10,n+11,n+12,n+13,n+14,n+15);for(let n=0;n<16;n+=2)_s(n,n+1,n+16,n+17,n+32,n+33,n+48,n+49,n+64,n+65,n+80,n+81,n+96,n+97,n+112,n+113);if(o)for(let n=0;n<256;n++)e[r+n]^=M[n]^e[t+n]^e[s+n];else for(let n=0;n<256;n++)e[r+n]=M[n]^e[t+n]^e[s+n];L(M)}function Xe(e,t){let s=Ht(e),r=new Uint32Array(1),o=Ht(r);if(r[0]=t,t<=64)return _t.create({dkLen:t}).update(o).update(s).digest();let n=new Uint8Array(t),i=_t.create({}).update(o).update(s).digest(),h=0;for(n.set(i.subarray(0,32)),h+=32;t-h>64;h+=32){let c=_t.create({}).update(i);c.digestInto(i),c.destroy(),n.set(i.subarray(0,32),h)}return n.set(_t(i,{dkLen:t-h}),h),L(i,r),F(n)}function Jn(e,t,s,r,o,n,i=!1){let h;e===0?t===0?h=o-1:i?h=t*r+o-1:h=t*r+(o==0?-1:0):i?h=s-r+o-1:h=s-r+(o==0?-1:0);let c=e!==0&&t!==oe-1?(t+1)*r:0,a=h-1-Re(h,Re(n,n).h).h;return(c+a)%s}var Us=Math.pow(2,32);function Et(e){return Number.isSafeInteger(e)&&e>=0&&e<Us}function Zn(e){let t={version:19,dkLen:32,maxmem:Us-1,asyncTick:10};for(let[c,a]of Object.entries(e))a!=null&&(t[c]=a);let{dkLen:s,p:r,m:o,t:n,version:i,onProgress:h}=t;if(!Et(s)||s<4)throw new Error("dkLen should be at least 4 bytes");if(!Et(r)||r<1||r>=Math.pow(2,24))throw new Error("p should be 1 <= p < 2^24");if(!Et(o))throw new Error("m should be 0 <= m < 2^32");if(!Et(n)||n<1)throw new Error("t (iterations) should be 1 <= t < 2^32");if(h!==void 0&&typeof h!="function")throw new Error("progressCb should be function");if(!Et(o)||o<8*r)throw new Error("memory should be at least 8*p bytes");if(i!==16&&i!==19)throw new Error("unknown version="+i);return t}function $n(e,t,s,r){if(e=dt(e),t=dt(t),U(e),U(t),!Et(e.length))throw new Error("password should be less than 4 GB");if(!Et(t.length)||t.length<8)throw new Error("salt should be at least 8 bytes and less than 4 GB");if(!Object.values(me).includes(s))throw new Error("invalid type");let{p:o,dkLen:n,m:i,t:h,version:c,key:a,personalization:f,maxmem:l,onProgress:u,asyncTick:p}=Zn(r);a=vs(a),f=vs(f);let x=_t.create({}),d=new Uint32Array(1),b=Ht(d);for(let O of[o,n,i,h,c,s])d[0]=O,x.update(b);for(let O of[e,t,a,f])d[0]=O.length,x.update(b).update(O);let g=new Uint32Array(18),A=Ht(g);x.digestInto(A);let m=o,w=4*o*Math.floor(i/(oe*o)),B=Math.floor(w/o),_=Math.floor(B/oe),I=w*256;if(!Et(l)||I>l)throw new Error("mem should be less than 2**32, got: maxmem="+l+", memused="+I);let v=new Uint32Array(I);for(let O=0;O<o;O++){let J=256*B*O;g[17]=O,g[16]=0,v.set(Xe(g,1024),J),g[16]=1,v.set(Xe(g,1024),J+256)}let T=()=>{};if(u){let O=h*oe*o*_,J=Math.max(Math.floor(O/1e4),1),K=0;T=()=>{K++,u&&(!(K%J)||K===O)&&u(K/O)}}return L(d,g),{type:s,mP:w,p:o,t:h,version:c,B:v,laneLen:B,lanes:m,segmentLen:_,dkLen:n,perBlock:T,asyncTick:p}}function Qn(e,t,s,r){let o=new Uint32Array(256);for(let i=0;i<t;i++)for(let h=0;h<256;h++)o[h]^=e[256*(s*i+s-1)+h];let n=Ht(Xe(o,r));return L(o),n}function tr(e,t,s,r,o,n,i,h,c,a,f,l,u){a%i&&(f=a-1);let p,x;if(l){let A=n%128;A===0&&(t[268]++,ie(t,256,2*256,0,!1),ie(t,0,2*256,0,!1)),p=t[2*A],x=t[2*A+1]}else{let A=256*f;p=e[A],x=e[A+1]}let d=r===0&&o===0?s:x%c,b=Jn(r,o,i,h,n,p,d==s),g=i*d+b;ie(e,256*f,256*g,a*256,u)}function er(e,t,s,r){let{mP:o,p:n,t:i,version:h,B:c,laneLen:a,lanes:f,segmentLen:l,dkLen:u,perBlock:p}=$n(t,s,e,r),x=new Uint32Array(3*256);x[262]=o,x[264]=i,x[266]=e;for(let d=0;d<i;d++){let b=d!==0&&h===19;x[256]=d;for(let g=0;g<oe;g++){x[260]=g;let A=e==me.Argon2i||e==me.Argon2id&&d===0&&g<2;for(let m=0;m<n;m++){x[258]=m,x[268]=0;let w=0;d===0&&g===0&&(w=2,A&&(x[268]++,ie(x,256,2*256,0,!1),ie(x,0,2*256,0,!1)));let B=m*a+g*l+w,_=B%a?B-1:B+a-1;for(let I=w;I<l;I++,B++,_++)p(),tr(c,x,m,d,g,I,a,l,f,B,_,A,b)}}}return L(x),Qn(c,n,a,u)}var Es=(e,t,s)=>er(me.Argon2id,e,t,s);var Ss=new Uint32Array(8),we=class extends it{constructor(t,s,r,o,n,i,h={}){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1;let{salt:c}=h;if(this.blockLen=t,this.outputLen=s,this.lengthFlag=r,this.counterLen=o,this.buffer=new Uint8Array(t),this.view=nt(this.buffer),c){let a=c;if(a=E(a),U(a),a.length!==4*n)throw new Error("wrong salt length");let f=this.salt=new Uint32Array(n),l=nt(a);this.constants=i.slice();for(let u=0,p=0;u<f.length;u++,p+=4)f[u]=l.getUint32(p,!1),this.constants[u]^=f[u]}else this.salt=Ss,this.constants=i}update(t){z(this),t=E(t),U(t);let{view:s,buffer:r,blockLen:o}=this,n=t.length,i;for(let h=0;h<n;){let c=Math.min(o-this.pos,n-h);if(c===o){for(i||(i=nt(t));o<=n-h;h+=o)this.length+=o,this.compress(i,h);continue}r.set(t.subarray(h,h+c),this.pos),this.pos+=c,h+=c,this.pos===o&&(this.length+=o,this.compress(s,0,!0),this.pos=0)}return this}destroy(){this.destroyed=!0,this.salt!==Ss&&L(this.salt,this.constants)}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{buffer:s,length:r,finished:o,destroyed:n,constants:i,salt:h,pos:c}=this;return t.buffer.set(s),t.constants=i.slice(),t.destroyed=n,t.finished=o,t.length=r,t.pos=c,t.salt=h.slice(),t}clone(){return this._cloneInto()}digestInto(t){z(this),ut(t,this),this.finished=!0;let{buffer:s,blockLen:r,counterLen:o,lengthFlag:n,view:i}=this;L(s.subarray(this.pos));let h=BigInt((this.length+this.pos)*8),c=r-o-1;s[this.pos]|=128,this.length+=this.pos,this.pos>c&&(this.compress(i,0),L(s),this.pos=0),s[c]|=n,Pe(i,r-8,h,!1),this.compress(i,0,this.pos!==0),L(s);let a=nt(t),f=this.get();for(let l=0;l<this.outputLen/4;++l)a.setUint32(l*4,f[l])}digest(){let{buffer:t,outputLen:s}=this;this.digestInto(t);let r=t.slice(0,s);return this.destroy(),r}},te=Uint32Array.from([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731,3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113]),Ve=te.slice(0,16),sr=st.slice(),nr=at.slice(),rr=P.slice(),or=N.slice();function ir(){let e=[];for(let t=0,s=0;t<14;t++,s+=16)for(let r=1;r<16;r+=2)e.push(Ve[S[s+r]]),e.push(Ve[S[s+r-1]]);return new Uint32Array(e)}var Q=ir(),V=new Uint32Array(16),Ae=class extends we{constructor(t,s,r,o={}){super(64,t,r,8,4,Ve,o),this.v0=s[0]|0,this.v1=s[1]|0,this.v2=s[2]|0,this.v3=s[3]|0,this.v4=s[4]|0,this.v5=s[5]|0,this.v6=s[6]|0,this.v7=s[7]|0}get(){let{v0:t,v1:s,v2:r,v3:o,v4:n,v5:i,v6:h,v7:c}=this;return[t,s,r,o,n,i,h,c]}set(t,s,r,o,n,i,h,c){this.v0=t|0,this.v1=s|0,this.v2=r|0,this.v3=o|0,this.v4=n|0,this.v5=i|0,this.v6=h|0,this.v7=c|0}destroy(){super.destroy(),this.set(0,0,0,0,0,0,0,0)}compress(t,s,r=!0){for(let _=0;_<16;_++,s+=4)V[_]=t.getUint32(s,!1);let o=this.v0|0,n=this.v1|0,i=this.v2|0,h=this.v3|0,c=this.v4|0,a=this.v5|0,f=this.v6|0,l=this.v7|0,u=this.constants[0]|0,p=this.constants[1]|0,x=this.constants[2]|0,d=this.constants[3]|0,{h:b,l:g}=pt(BigInt(r?this.length*8:0)),A=(this.constants[4]^g)>>>0,m=(this.constants[5]^g)>>>0,w=(this.constants[6]^b)>>>0,B=(this.constants[7]^b)>>>0;for(let _=0,I=0,v=0;_<14;_++)({a:o,b:c,c:u,d:A}=R(o,c,u,A,V[S[I++]]^Q[v++])),{a:o,b:c,c:u,d:A}=X(o,c,u,A,V[S[I++]]^Q[v++]),{a:n,b:a,c:p,d:m}=R(n,a,p,m,V[S[I++]]^Q[v++]),{a:n,b:a,c:p,d:m}=X(n,a,p,m,V[S[I++]]^Q[v++]),{a:i,b:f,c:x,d:w}=R(i,f,x,w,V[S[I++]]^Q[v++]),{a:i,b:f,c:x,d:w}=X(i,f,x,w,V[S[I++]]^Q[v++]),{a:h,b:l,c:d,d:B}=R(h,l,d,B,V[S[I++]]^Q[v++]),{a:h,b:l,c:d,d:B}=X(h,l,d,B,V[S[I++]]^Q[v++]),{a:o,b:a,c:x,d:B}=R(o,a,x,B,V[S[I++]]^Q[v++]),{a:o,b:a,c:x,d:B}=X(o,a,x,B,V[S[I++]]^Q[v++]),{a:n,b:f,c:d,d:A}=R(n,f,d,A,V[S[I++]]^Q[v++]),{a:n,b:f,c:d,d:A}=X(n,f,d,A,V[S[I++]]^Q[v++]),{a:i,b:l,c:u,d:m}=R(i,l,u,m,V[S[I++]]^Q[v++]),{a:i,b:l,c:u,d:m}=X(i,l,u,m,V[S[I++]]^Q[v++]),{a:h,b:c,c:p,d:w}=R(h,c,p,w,V[S[I++]]^Q[v++]),{a:h,b:c,c:p,d:w}=X(h,c,p,w,V[S[I++]]^Q[v++]);this.v0=(this.v0^o^u^this.salt[0])>>>0,this.v1=(this.v1^n^p^this.salt[1])>>>0,this.v2=(this.v2^i^x^this.salt[2])>>>0,this.v3=(this.v3^h^d^this.salt[3])>>>0,this.v4=(this.v4^c^A^this.salt[0])>>>0,this.v5=(this.v5^a^m^this.salt[1])>>>0,this.v6=(this.v6^f^w^this.salt[2])>>>0,this.v7=(this.v7^l^B^this.salt[3])>>>0,L(V)}},y=new Uint32Array(32),j=new Uint32Array(32);function hr(){let e=[];for(let t=0,s=0;t<16;t++,s+=16)for(let r=1;r<16;r+=2)e.push(te[S[s+r]*2+0]),e.push(te[S[s+r]*2+1]),e.push(te[S[s+r-1]*2+0]),e.push(te[S[s+r-1]*2+1]);return new Uint32Array(e)}var Be=hr();function St(e,t,s,r,o,n){let i=2*S[n],h=o[i+1]^Be[n*2+1],c=o[i]^Be[n*2],a=y[2*e+1],f=y[2*e],l=y[2*t+1],u=y[2*t],p=y[2*s+1],x=y[2*s],d=y[2*r+1],b=y[2*r],g=xt(a,l,h);f=bt(g,f,u,c)>>>0,a=(g|0)>>>0,{Dh:b,Dl:d}={Dh:b^f,Dl:d^a},{Dh:b,Dl:d}={Dh:Jt(b,d),Dl:Zt(b,d)},{h:x,l:p}=$(x,p,b,d),{Bh:u,Bl:l}={Bh:u^x,Bl:l^p},{Bh:u,Bl:l}={Bh:W(u,l,25),Bl:Y(u,l,25)},y[2*e+1]=a,y[2*e]=f,y[2*t+1]=l,y[2*t]=u,y[2*s+1]=p,y[2*s]=x,y[2*r+1]=d,y[2*r]=b}function Ot(e,t,s,r,o,n){let i=2*S[n],h=o[i+1]^Be[n*2+1],c=o[i]^Be[n*2],a=y[2*e+1],f=y[2*e],l=y[2*t+1],u=y[2*t],p=y[2*s+1],x=y[2*s],d=y[2*r+1],b=y[2*r],g=xt(a,l,h);f=bt(g,f,u,c),a=g|0,{Dh:b,Dl:d}={Dh:b^f,Dl:d^a},{Dh:b,Dl:d}={Dh:W(b,d,16),Dl:Y(b,d,16)},{h:x,l:p}=$(x,p,b,d),{Bh:u,Bl:l}={Bh:u^x,Bl:l^p},{Bh:u,Bl:l}={Bh:W(u,l,11),Bl:Y(u,l,11)},y[2*e+1]=a,y[2*e]=f,y[2*t+1]=l,y[2*t]=u,y[2*s+1]=p,y[2*s]=x,y[2*r+1]=d,y[2*r]=b}var Le=class extends we{constructor(t,s,r,o={}){super(128,t,r,16,8,te,o),this.v0l=s[0]|0,this.v0h=s[1]|0,this.v1l=s[2]|0,this.v1h=s[3]|0,this.v2l=s[4]|0,this.v2h=s[5]|0,this.v3l=s[6]|0,this.v3h=s[7]|0,this.v4l=s[8]|0,this.v4h=s[9]|0,this.v5l=s[10]|0,this.v5h=s[11]|0,this.v6l=s[12]|0,this.v6h=s[13]|0,this.v7l=s[14]|0,this.v7h=s[15]|0}get(){let{v0l:t,v0h:s,v1l:r,v1h:o,v2l:n,v2h:i,v3l:h,v3h:c,v4l:a,v4h:f,v5l:l,v5h:u,v6l:p,v6h:x,v7l:d,v7h:b}=this;return[t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b]}set(t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b){this.v0l=t|0,this.v0h=s|0,this.v1l=r|0,this.v1h=o|0,this.v2l=n|0,this.v2h=i|0,this.v3l=h|0,this.v3h=c|0,this.v4l=a|0,this.v4h=f|0,this.v5l=l|0,this.v5h=u|0,this.v6l=p|0,this.v6h=x|0,this.v7l=d|0,this.v7h=b|0}destroy(){super.destroy(),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}compress(t,s,r=!0){for(let o=0;o<32;o++,s+=4)j[o]=t.getUint32(s,!1);if(this.get().forEach((o,n)=>y[n]=o),y.set(this.constants.subarray(0,16),16),r){let{h:o,l:n}=pt(BigInt(this.length*8));y[24]=(y[24]^o)>>>0,y[25]=(y[25]^n)>>>0,y[26]=(y[26]^o)>>>0,y[27]=(y[27]^n)>>>0}for(let o=0,n=0;o<16;o++)St(0,4,8,12,j,n++),Ot(0,4,8,12,j,n++),St(1,5,9,13,j,n++),Ot(1,5,9,13,j,n++),St(2,6,10,14,j,n++),Ot(2,6,10,14,j,n++),St(3,7,11,15,j,n++),Ot(3,7,11,15,j,n++),St(0,5,10,15,j,n++),Ot(0,5,10,15,j,n++),St(1,6,11,12,j,n++),Ot(1,6,11,12,j,n++),St(2,7,8,13,j,n++),Ot(2,7,8,13,j,n++),St(3,4,9,14,j,n++),Ot(3,4,9,14,j,n++);this.v0l^=y[0]^y[16]^this.salt[0],this.v0h^=y[1]^y[17]^this.salt[1],this.v1l^=y[2]^y[18]^this.salt[2],this.v1h^=y[3]^y[19]^this.salt[3],this.v2l^=y[4]^y[20]^this.salt[4],this.v2h^=y[5]^y[21]^this.salt[5],this.v3l^=y[6]^y[22]^this.salt[6],this.v3h^=y[7]^y[23]^this.salt[7],this.v4l^=y[8]^y[24]^this.salt[0],this.v4h^=y[9]^y[25]^this.salt[1],this.v5l^=y[10]^y[26]^this.salt[2],this.v5h^=y[11]^y[27]^this.salt[3],this.v6l^=y[12]^y[28]^this.salt[4],this.v6h^=y[13]^y[29]^this.salt[5],this.v7l^=y[14]^y[30]^this.salt[6],this.v7h^=y[15]^y[31]^this.salt[7],L(y,j)}},je=class extends Ae{constructor(t={}){super(28,nr,0,t)}},Ke=class extends Ae{constructor(t={}){super(32,sr,1,t)}},ze=class extends Le{constructor(t={}){super(48,rr,0,t)}},We=class extends Le{constructor(t={}){super(64,or,1,t)}},Os=ct(e=>new je(e)),Ds=ct(e=>new Ke(e)),Cs=ct(e=>new ze(e)),Ts=ct(e=>new We(e));var gt={CHUNK_START:1,CHUNK_END:2,PARENT:4,ROOT:8,KEYED_HASH:16,DERIVE_KEY_CONTEXT:32,DERIVE_KEY_MATERIAL:64},Bt=st.slice(),Fs=(()=>{let e=Array.from({length:16},(r,o)=>o),t=r=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(o=>r[o]),s=[];for(let r=0,o=e;r<7;r++,o=t(o))s.push(...o);return Uint8Array.from(s)})(),Ye=class e extends Qt{constructor(t={},s=0){super(64,t.dkLen===void 0?32:t.dkLen),this.chunkPos=0,this.chunksDone=0,this.flags=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0;let{key:r,context:o}=t,n=o!==void 0;if(r!==void 0){if(n)throw new Error('Only "key" or "context" can be specified at same time');let i=E(r).slice();U(i,32),this.IV=F(i),C(this.IV),this.flags=s|gt.KEYED_HASH}else if(n){let i=E(o),h=new e({dkLen:32},gt.DERIVE_KEY_CONTEXT).update(i).digest();this.IV=F(h),C(this.IV),this.flags=s|gt.DERIVE_KEY_MATERIAL}else this.IV=Bt.slice(),this.flags=s;this.state=this.IV.slice(),this.bufferOut=Ht(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,s,r,o=0){let{state:n,pos:i}=this,{h,l:c}=pt(BigInt(t),!0),{v0:a,v1:f,v2:l,v3:u,v4:p,v5:x,v6:d,v7:b,v8:g,v9:A,v10:m,v11:w,v12:B,v13:_,v14:I,v15:v}=ye(Fs,o,r,7,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],Bt[0],Bt[1],Bt[2],Bt[3],h,c,i,s);n[0]=a^g,n[1]=f^A,n[2]=l^m,n[3]=u^w,n[4]=p^B,n[5]=x^_,n[6]=d^I,n[7]=b^v}compress(t,s=0,r=!1){let o=this.flags;if(this.chunkPos||(o|=gt.CHUNK_START),(this.chunkPos===15||r)&&(o|=gt.CHUNK_END),r||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,o,t,s),this.chunkPos+=1,this.chunkPos===16||r){let n=this.state;this.state=this.IV.slice();for(let i,h=this.chunksDone+1;(r||!(h&1))&&(i=this.stack.pop());h>>=1)this.buffer32.set(i,0),this.buffer32.set(n,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|gt.PARENT,this.buffer32,0),n=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(n)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:s,flags:r,state:o,chunkPos:n,posOut:i,chunkOut:h,stack:c,chunksDone:a}=this;return t.state.set(o.slice()),t.stack=c.map(f=>Uint32Array.from(f)),t.IV.set(s),t.flags=r,t.chunkPos=n,t.chunksDone=a,t.posOut=i,t.chunkOut=h,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,L(this.state,this.buffer32,this.IV,this.bufferOut32),L(...this.stack)}b2CompressOut(){let{state:t,pos:s,flags:r,buffer32:o,bufferOut32:n}=this,{h:i,l:h}=pt(BigInt(this.chunkOut++));C(o);let{v0:c,v1:a,v2:f,v3:l,v4:u,v5:p,v6:x,v7:d,v8:b,v9:g,v10:A,v11:m,v12:w,v13:B,v14:_,v15:I}=ye(Fs,0,o,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],Bt[0],Bt[1],Bt[2],Bt[3],h,i,s,r);n[0]=c^b,n[1]=a^g,n[2]=f^A,n[3]=l^m,n[4]=u^w,n[5]=p^B,n[6]=x^_,n[7]=d^I,n[8]=t[0]^b,n[9]=t[1]^g,n[10]=t[2]^A,n[11]=t[3]^m,n[12]=t[4]^w,n[13]=t[5]^B,n[14]=t[6]^_,n[15]=t[7]^I,C(o),C(n),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,L(this.buffer.subarray(this.pos));let t=this.flags|gt.ROOT;this.stack.length?(t|=gt.PARENT,C(this.buffer32),this.compress(this.buffer32,0,!0),C(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:gt.CHUNK_START)|gt.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){z(this,!1),U(t),this.finish();let{blockLen:s,bufferOut:r}=this;for(let o=0,n=t.length;o<n;){this.posOut>=s&&this.b2CompressOut();let i=Math.min(s-this.posOut,n-o);t.set(r.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return D(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(ut(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}},Ms=Wt(e=>new Ye(e));var He=class extends it{constructor(t,s){super(),this.finished=!1,this.destroyed=!1,zt(t);let r=E(s);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,n=new Uint8Array(o);n.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<n.length;i++)n[i]^=54;this.iHash.update(n),this.oHash=t.create();for(let i=0;i<n.length;i++)n[i]^=106;this.oHash.update(n),L(n)}update(t){return z(this),this.iHash.update(t),this}digestInto(t){z(this),U(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:s,iHash:r,finished:o,destroyed:n,blockLen:i,outputLen:h}=this;return t=t,t.finished=o,t.destroyed=n,t.blockLen=i,t.outputLen=h,t.oHash=s._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Dt=(e,t,s)=>new He(e,t).update(s).digest();Dt.create=(e,t)=>new He(e,t);function cr(e,t,s){return zt(e),s===void 0&&(s=new Uint8Array(e.outputLen)),Dt(e,E(s),E(t))}var qe=Uint8Array.from([0]),Ps=Uint8Array.of();function ar(e,t,s,r=32){zt(e),D(r);let o=e.outputLen;if(r>255*o)throw new Error("Length should be <= 255*HashLen");let n=Math.ceil(r/o);s===void 0&&(s=Ps);let i=new Uint8Array(n*o),h=Dt.create(e,t),c=h._cloneInto(),a=new Uint8Array(h.outputLen);for(let f=0;f<n;f++)qe[0]=f+1,c.update(f===0?Ps:a).update(s).update(qe).digestInto(a),i.set(a,o*f),h._cloneInto(c);return h.destroy(),c.destroy(),L(a,qe),i.slice(0,r)}var Ie=(e,t,s,r,o)=>ar(e,cr(e,t,s),r,o);function Ns(e,t,s,r){zt(e);let o=pe({dkLen:32,asyncTick:10},r),{c:n,dkLen:i,asyncTick:h}=o;if(D(n),D(i),D(h),n<1)throw new Error("iterations (c) should be >= 1");let c=dt(t),a=dt(s),f=new Uint8Array(i),l=Dt.create(e,c),u=l._cloneInto().update(a);return{c:n,dkLen:i,asyncTick:h,DK:f,PRF:l,PRFSalt:u}}function Gs(e,t,s,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),L(o),s}function Yt(e,t,s,r){let{c:o,dkLen:n,DK:i,PRF:h,PRFSalt:c}=Ns(e,t,s,r),a,f=new Uint8Array(4),l=nt(f),u=new Uint8Array(h.outputLen);for(let p=1,x=0;x<n;p++,x+=h.outputLen){let d=i.subarray(x,x+h.outputLen);l.setInt32(0,p,!1),(a=c._cloneInto(a)).update(f).digestInto(u),d.set(u.subarray(0,d.length));for(let b=1;b<o;b++){h._cloneInto(a).update(u).digestInto(u);for(let g=0;g<d.length;g++)d[g]^=u[g]}}return Gs(h,c,i,a,u)}async function Rs(e,t,s,r){let{c:o,dkLen:n,asyncTick:i,DK:h,PRF:c,PRFSalt:a}=Ns(e,t,s,r),f,l=new Uint8Array(4),u=nt(l),p=new Uint8Array(c.outputLen);for(let x=1,d=0;d<n;x++,d+=c.outputLen){let b=h.subarray(d,d+c.outputLen);u.setInt32(0,x,!1),(f=a._cloneInto(f)).update(l).digestInto(p),b.set(p.subarray(0,b.length)),await re(o-1,i,()=>{c._cloneInto(f).update(p).digestInto(p);for(let g=0;g<b.length;g++)b[g]^=p[g]})}return Gs(c,a,h,f,p)}var lr=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ct=new Uint32Array(64),he=class extends At{constructor(t=32){super(64,t,8,!1),this.A=st[0]|0,this.B=st[1]|0,this.C=st[2]|0,this.D=st[3]|0,this.E=st[4]|0,this.F=st[5]|0,this.G=st[6]|0,this.H=st[7]|0}get(){let{A:t,B:s,C:r,D:o,E:n,F:i,G:h,H:c}=this;return[t,s,r,o,n,i,h,c]}set(t,s,r,o,n,i,h,c){this.A=t|0,this.B=s|0,this.C=r|0,this.D=o|0,this.E=n|0,this.F=i|0,this.G=h|0,this.H=c|0}process(t,s){for(let l=0;l<16;l++,s+=4)Ct[l]=t.getUint32(s,!1);for(let l=16;l<64;l++){let u=Ct[l-15],p=Ct[l-2],x=Z(u,7)^Z(u,18)^u>>>3,d=Z(p,17)^Z(p,19)^p>>>10;Ct[l]=d+Ct[l-7]+x+Ct[l-16]|0}let{A:r,B:o,C:n,D:i,E:h,F:c,G:a,H:f}=this;for(let l=0;l<64;l++){let u=Z(h,6)^Z(h,11)^Z(h,25),p=f+u+$t(h,c,a)+lr[l]+Ct[l]|0,d=(Z(r,2)^Z(r,13)^Z(r,22))+ge(r,o,n)|0;f=a,a=c,c=h,h=i+p|0,i=n,n=o,o=r,r=p+d|0}r=r+this.A|0,o=o+this.B|0,n=n+this.C|0,i=i+this.D|0,h=h+this.E|0,c=c+this.F|0,a=a+this.G|0,f=f+this.H|0,this.set(r,o,n,i,h,c,a,f)}roundClean(){L(Ct)}destroy(){this.set(0,0,0,0,0,0,0,0),L(this.buffer)}},ve=class extends he{constructor(){super(28),this.A=at[0]|0,this.B=at[1]|0,this.C=at[2]|0,this.D=at[3]|0,this.E=at[4]|0,this.F=at[5]|0,this.G=at[6]|0,this.H=at[7]|0}},Xs=be(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),fr=Xs[0],ur=Xs[1],Tt=new Uint32Array(80),Ft=new Uint32Array(80),ee=class extends At{constructor(t=64){super(128,t,16,!1),this.Ah=N[0]|0,this.Al=N[1]|0,this.Bh=N[2]|0,this.Bl=N[3]|0,this.Ch=N[4]|0,this.Cl=N[5]|0,this.Dh=N[6]|0,this.Dl=N[7]|0,this.Eh=N[8]|0,this.El=N[9]|0,this.Fh=N[10]|0,this.Fl=N[11]|0,this.Gh=N[12]|0,this.Gl=N[13]|0,this.Hh=N[14]|0,this.Hl=N[15]|0}get(){let{Ah:t,Al:s,Bh:r,Bl:o,Ch:n,Cl:i,Dh:h,Dl:c,Eh:a,El:f,Fh:l,Fl:u,Gh:p,Gl:x,Hh:d,Hl:b}=this;return[t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b]}set(t,s,r,o,n,i,h,c,a,f,l,u,p,x,d,b){this.Ah=t|0,this.Al=s|0,this.Bh=r|0,this.Bl=o|0,this.Ch=n|0,this.Cl=i|0,this.Dh=h|0,this.Dl=c|0,this.Eh=a|0,this.El=f|0,this.Fh=l|0,this.Fl=u|0,this.Gh=p|0,this.Gl=x|0,this.Hh=d|0,this.Hl=b|0}process(t,s){for(let m=0;m<16;m++,s+=4)Tt[m]=t.getUint32(s),Ft[m]=t.getUint32(s+=4);for(let m=16;m<80;m++){let w=Tt[m-15]|0,B=Ft[m-15]|0,_=W(w,B,1)^W(w,B,8)^Te(w,B,7),I=Y(w,B,1)^Y(w,B,8)^Fe(w,B,7),v=Tt[m-2]|0,T=Ft[m-2]|0,O=W(v,T,19)^mt(v,T,61)^Te(v,T,6),J=Y(v,T,19)^wt(v,T,61)^Fe(v,T,6),K=ws(I,J,Ft[m-7],Ft[m-16]),ht=As(K,_,O,Tt[m-7],Tt[m-16]);Tt[m]=ht|0,Ft[m]=K|0}let{Ah:r,Al:o,Bh:n,Bl:i,Ch:h,Cl:c,Dh:a,Dl:f,Eh:l,El:u,Fh:p,Fl:x,Gh:d,Gl:b,Hh:g,Hl:A}=this;for(let m=0;m<80;m++){let w=W(l,u,14)^W(l,u,18)^mt(l,u,41),B=Y(l,u,14)^Y(l,u,18)^wt(l,u,41),_=l&p^~l&d,I=u&x^~u&b,v=Bs(A,B,I,ur[m],Ft[m]),T=Ls(v,g,w,_,fr[m],Tt[m]),O=v|0,J=W(r,o,28)^mt(r,o,34)^mt(r,o,39),K=Y(r,o,28)^wt(r,o,34)^wt(r,o,39),ht=r&n^r&h^n&h,yt=o&i^o&c^i&c;g=d|0,A=b|0,d=p|0,b=x|0,p=l|0,x=u|0,{h:l,l:u}=$(a|0,f|0,T|0,O|0),a=h|0,f=c|0,h=n|0,c=i|0,n=r|0,i=o|0;let ft=xt(O,K,yt);r=bt(ft,T,J,ht),o=ft|0}({h:r,l:o}=$(this.Ah|0,this.Al|0,r|0,o|0)),{h:n,l:i}=$(this.Bh|0,this.Bl|0,n|0,i|0),{h,l:c}=$(this.Ch|0,this.Cl|0,h|0,c|0),{h:a,l:f}=$(this.Dh|0,this.Dl|0,a|0,f|0),{h:l,l:u}=$(this.Eh|0,this.El|0,l|0,u|0),{h:p,l:x}=$(this.Fh|0,this.Fl|0,p|0,x|0),{h:d,l:b}=$(this.Gh|0,this.Gl|0,d|0,b|0),{h:g,l:A}=$(this.Hh|0,this.Hl|0,g|0,A|0),this.set(r,o,n,i,h,c,a,f,l,u,p,x,d,b,g,A)}roundClean(){L(Tt,Ft)}destroy(){L(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Je=class extends ee{constructor(){super(48),this.Ah=P[0]|0,this.Al=P[1]|0,this.Bh=P[2]|0,this.Bl=P[3]|0,this.Ch=P[4]|0,this.Cl=P[5]|0,this.Dh=P[6]|0,this.Dl=P[7]|0,this.Eh=P[8]|0,this.El=P[9]|0,this.Fh=P[10]|0,this.Fl=P[11]|0,this.Gh=P[12]|0,this.Gl=P[13]|0,this.Hh=P[14]|0,this.Hl=P[15]|0}},tt=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),et=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Ze=class extends ee{constructor(){super(28),this.Ah=tt[0]|0,this.Al=tt[1]|0,this.Bh=tt[2]|0,this.Bl=tt[3]|0,this.Ch=tt[4]|0,this.Cl=tt[5]|0,this.Dh=tt[6]|0,this.Dl=tt[7]|0,this.Eh=tt[8]|0,this.El=tt[9]|0,this.Fh=tt[10]|0,this.Fl=tt[11]|0,this.Gh=tt[12]|0,this.Gl=tt[13]|0,this.Hh=tt[14]|0,this.Hl=tt[15]|0}},$e=class extends ee{constructor(){super(32),this.Ah=et[0]|0,this.Al=et[1]|0,this.Bh=et[2]|0,this.Bl=et[3]|0,this.Ch=et[4]|0,this.Cl=et[5]|0,this.Dh=et[6]|0,this.Dl=et[7]|0,this.Eh=et[8]|0,this.El=et[9]|0,this.Fh=et[10]|0,this.Fl=et[11]|0,this.Gh=et[12]|0,this.Gl=et[13]|0,this.Hh=et[14]|0,this.Hl=et[15]|0}},qt=ot(()=>new he),Qe=ot(()=>new ve),Vs=ot(()=>new ee),js=ot(()=>new Je),Ks=ot(()=>new $e),zs=ot(()=>new Ze);function Ws(e,t,s,r,o,n){let i=e[t++]^s[r++],h=e[t++]^s[r++],c=e[t++]^s[r++],a=e[t++]^s[r++],f=e[t++]^s[r++],l=e[t++]^s[r++],u=e[t++]^s[r++],p=e[t++]^s[r++],x=e[t++]^s[r++],d=e[t++]^s[r++],b=e[t++]^s[r++],g=e[t++]^s[r++],A=e[t++]^s[r++],m=e[t++]^s[r++],w=e[t++]^s[r++],B=e[t++]^s[r++],_=i,I=h,v=c,T=a,O=f,J=l,K=u,ht=p,yt=x,ft=d,Nt=b,Gt=g,Rt=A,Xt=m,Vt=w,jt=B;for(let cs=0;cs<8;cs+=2)O^=H(_+Rt|0,7),yt^=H(O+_|0,9),Rt^=H(yt+O|0,13),_^=H(Rt+yt|0,18),ft^=H(J+I|0,7),Xt^=H(ft+J|0,9),I^=H(Xt+ft|0,13),J^=H(I+Xt|0,18),Vt^=H(Nt+K|0,7),v^=H(Vt+Nt|0,9),K^=H(v+Vt|0,13),Nt^=H(K+v|0,18),T^=H(jt+Gt|0,7),ht^=H(T+jt|0,9),Gt^=H(ht+T|0,13),jt^=H(Gt+ht|0,18),I^=H(_+T|0,7),v^=H(I+_|0,9),T^=H(v+I|0,13),_^=H(T+v|0,18),K^=H(J+O|0,7),ht^=H(K+J|0,9),O^=H(ht+K|0,13),J^=H(O+ht|0,18),Gt^=H(Nt+ft|0,7),yt^=H(Gt+Nt|0,9),ft^=H(yt+Gt|0,13),Nt^=H(ft+yt|0,18),Rt^=H(jt+Vt|0,7),Xt^=H(Rt+jt|0,9),Vt^=H(Xt+Rt|0,13),jt^=H(Vt+Xt|0,18);o[n++]=i+_|0,o[n++]=h+I|0,o[n++]=c+v|0,o[n++]=a+T|0,o[n++]=f+O|0,o[n++]=l+J|0,o[n++]=u+K|0,o[n++]=p+ht|0,o[n++]=x+yt|0,o[n++]=d+ft|0,o[n++]=b+Nt|0,o[n++]=g+Gt|0,o[n++]=A+Rt|0,o[n++]=m+Xt|0,o[n++]=w+Vt|0,o[n++]=B+jt|0}function se(e,t,s,r,o){let n=r+0,i=r+16*o;for(let h=0;h<16;h++)s[i+h]=e[t+(2*o-1)*16+h];for(let h=0;h<o;h++,n+=16,t+=16)Ws(s,i,e,t,s,n),h>0&&(i+=16),Ws(s,n,e,t+=16,s,i)}function Ys(e,t,s){let r=pe({dkLen:32,asyncTick:10,maxmem:1073742848},s),{N:o,r:n,p:i,dkLen:h,asyncTick:c,maxmem:a,onProgress:f}=r;if(D(o),D(n),D(i),D(h),D(c),D(a),f!==void 0&&typeof f!="function")throw new Error("progressCb should be function");let l=128*n,u=l/4,p=Math.pow(2,32);if(o<=1||(o&o-1)!==0||o>p)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(i<0||i>(p-1)*32/l)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(h<0||h>(p-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(l*(o+i)>a)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+a);let d=Yt(qt,e,t,{c:1,dkLen:l*i}),b=F(d),g=F(new Uint8Array(l*o)),A=F(new Uint8Array(l)),m=()=>{};if(f){let w=2*o*i,B=Math.max(Math.floor(w/1e4),1),_=0;m=()=>{_++,f&&(!(_%B)||_===w)&&f(_/w)}}return{N:o,r:n,p:i,dkLen:h,blockSize32:u,V:g,B32:b,B:d,tmp:A,blockMixCb:m,asyncTick:c}}function qs(e,t,s,r,o){let n=Yt(qt,e,s,{c:1,dkLen:t});return L(s,r,o),n}function _e(e,t,s){let{N:r,r:o,p:n,dkLen:i,blockSize32:h,V:c,B32:a,B:f,tmp:l,blockMixCb:u}=Ys(e,t,s);C(a);for(let p=0;p<n;p++){let x=h*p;for(let d=0;d<h;d++)c[d]=a[x+d];for(let d=0,b=0;d<r-1;d++)se(c,b,c,b+=h,o),u();se(c,(r-1)*h,a,x,o),u();for(let d=0;d<r;d++){let b=a[x+h-16]%r;for(let g=0;g<h;g++)l[g]=a[x+g]^c[b*h+g];se(l,0,a,x,o),u()}}return C(a),qs(e,i,f,c,l)}async function Js(e,t,s){let{N:r,r:o,p:n,dkLen:i,blockSize32:h,V:c,B32:a,B:f,tmp:l,blockMixCb:u,asyncTick:p}=Ys(e,t,s);C(a);for(let x=0;x<n;x++){let d=h*x;for(let g=0;g<h;g++)c[g]=a[d+g];let b=0;await re(r-1,p,()=>{se(c,b,c,b+=h,o),u()}),se(c,(r-1)*h,a,d,o),u(),await re(r,p,()=>{let g=a[d+h-16]%r;for(let A=0;A<h;A++)l[A]=a[d+A]^c[g*h+A];se(l,0,a,d,o),u()})}return C(a),qs(e,i,f,c,l)}var ts=qt;var dr=2**19,pr=2**17;function xr(e,t){return _e(e,t,{N:dr,r:8,p:1,dkLen:32})}function br(e,t){return Yt(ts,e,t,{c:pr,dkLen:32})}function gr(e,t){U(e,32),U(t,32);let s=new Uint8Array(32);for(let r=0;r<32;r++)s[r]=e[r]^t[r];return s}function Ue(e,t,s){return typeof e=="string"&&e.length>=t&&e.length<=s}function yr(e,t){if(!Ue(e,8,255))throw new Error("invalid username");if(!Ue(t,8,255))throw new Error("invalid password");let s={_1:1,_2:2},r={s:String.fromCharCode(s._1),p:String.fromCharCode(s._2)},o=xr(t+r.s,e+r.s),n=br(t+r.p,e+r.p),i=gr(o,n);return L(o,n),i}function kr(e,t=0){if(!(Ue(e,3,15)&&/^[a-z0-9]{3,15}$/.test(e)))throw new Error("invalid protocol");let s=/^password\d{0,3}|ssh|tor|file$/.test(e),r;if(typeof t=="string"){if(!s)throw new Error("accountId must be a number");if(!Ue(t,1,255))throw new Error("accountId must be string of length 1..255");r=dt(t)}else if(Number.isSafeInteger(t)){if(t<0||t>Math.pow(2,32)-1)throw new Error("invalid accountId");r=new Uint8Array(4),nt(r).setUint32(0,t,!1)}else throw new Error("accountId must be a number"+(s?" or string":""));let o=dt(e);return{salt:r,info:o}}function mr(e){if(typeof e!="bigint"||e<=BigInt(128))throw new Error("invalid number");return Math.ceil(e.toString(2).length/8)}function wr(e){if(!e||typeof e!="object")return 32;let t="keyLength"in e,s="modulus"in e;if(t&&s)throw new Error("cannot combine keyLength and modulus options");if(!t&&!s)throw new Error("must have either keyLength or modulus option");let r=s?mr(e.modulus)+8:e.keyLength;if(!(typeof r=="number"&&r>=16&&r<=8192))throw new Error("invalid keyLength");return r}function Ar(e,t){let s=BigInt(1),o=BigInt("0x"+fe(e))%(t-s)+s;if(o<s)throw new Error("expected positive number");let n=e.length-8,i=o.toString(16).padStart(n*2,"0"),h=ue(i);if(h.length!==n)throw new Error("invalid length of result key");return h}async function Zs(e,t){let s=yr(e,t);function r(i,h=0,c){U(s,32);let{salt:a,info:f}=kr(i,h),l=wr(c),u=Ie(ts,s,a,f,l);return c&&"modulus"in c?Ar(u,c.modulus):u}function o(){s&&s.fill(1),s=void 0}let n=Array.from(r("fingerprint",0)).slice(0,6).map(i=>i.toString(16).padStart(2,"0").toUpperCase()).join(":");return Object.freeze({deriveChildKey:r,expire:o,fingerprint:n})}var ne=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),Mt=new Uint32Array(80),ss=class extends At{constructor(){super(64,20,8,!1),this.A=ne[0]|0,this.B=ne[1]|0,this.C=ne[2]|0,this.D=ne[3]|0,this.E=ne[4]|0}get(){let{A:t,B:s,C:r,D:o,E:n}=this;return[t,s,r,o,n]}set(t,s,r,o,n){this.A=t|0,this.B=s|0,this.C=r|0,this.D=o|0,this.E=n|0}process(t,s){for(let c=0;c<16;c++,s+=4)Mt[c]=t.getUint32(s,!1);for(let c=16;c<80;c++)Mt[c]=H(Mt[c-3]^Mt[c-8]^Mt[c-14]^Mt[c-16],1);let{A:r,B:o,C:n,D:i,E:h}=this;for(let c=0;c<80;c++){let a,f;c<20?(a=$t(o,n,i),f=1518500249):c<40?(a=o^n^i,f=1859775393):c<60?(a=ge(o,n,i),f=2400959708):(a=o^n^i,f=3395469782);let l=H(r,5)+a+h+f+Mt[c]|0;h=i,i=n,n=H(o,30),o=r,r=l}r=r+this.A|0,o=o+this.B|0,n=n+this.C|0,i=i+this.D|0,h=h+this.E|0,this.set(r,o,n,i,h)}roundClean(){L(Mt)}destroy(){this.set(0,0,0,0,0),L(this.buffer)}},Qs=ot(()=>new ss),Br=Math.pow(2,32),Lr=Array.from({length:64},(e,t)=>Math.floor(Br*Math.abs(Math.sin(t+1)))),Ee=ne.slice(0,4),es=new Uint32Array(16),ns=class extends At{constructor(){super(64,16,8,!0),this.A=Ee[0]|0,this.B=Ee[1]|0,this.C=Ee[2]|0,this.D=Ee[3]|0}get(){let{A:t,B:s,C:r,D:o}=this;return[t,s,r,o]}set(t,s,r,o){this.A=t|0,this.B=s|0,this.C=r|0,this.D=o|0}process(t,s){for(let h=0;h<16;h++,s+=4)es[h]=t.getUint32(s,!0);let{A:r,B:o,C:n,D:i}=this;for(let h=0;h<64;h++){let c,a,f;h<16?(c=$t(o,n,i),a=h,f=[7,12,17,22]):h<32?(c=$t(i,o,n),a=(5*h+1)%16,f=[5,9,14,20]):h<48?(c=o^n^i,a=(3*h+5)%16,f=[4,11,16,23]):(c=n^(o|~i),a=7*h%16,f=[6,10,15,21]),c=c+r+Lr[h]+es[a],r=i,i=n,n=o,o=o+H(c,f[h%4])}r=r+this.A|0,o=o+this.B|0,n=n+this.C|0,i=i+this.D|0,this.set(r,o,n,i)}roundClean(){L(es)}destroy(){this.set(0,0,0,0),L(this.buffer)}},tn=ot(()=>new ns),Hr=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),en=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Ir=en.map(e=>(9*e+5)%16),sn=(()=>{let s=[[en],[Ir]];for(let r=0;r<4;r++)for(let o of s)o.push(o[r].map(n=>Hr[n]));return s})(),nn=sn[0],rn=sn[1],on=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),vr=nn.map((e,t)=>e.map(s=>on[t][s])),_r=rn.map((e,t)=>e.map(s=>on[t][s])),Ur=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Er=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function $s(e,t,s,r){return e===0?t^s^r:e===1?t&s|~t&r:e===2?(t|~s)^r:e===3?t&r|s&~r:t^(s|~r)}var Se=new Uint32Array(16),rs=class extends At{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:s,h2:r,h3:o,h4:n}=this;return[t,s,r,o,n]}set(t,s,r,o,n){this.h0=t|0,this.h1=s|0,this.h2=r|0,this.h3=o|0,this.h4=n|0}process(t,s){for(let p=0;p<16;p++,s+=4)Se[p]=t.getUint32(s,!0);let r=this.h0|0,o=r,n=this.h1|0,i=n,h=this.h2|0,c=h,a=this.h3|0,f=a,l=this.h4|0,u=l;for(let p=0;p<5;p++){let x=4-p,d=Ur[p],b=Er[p],g=nn[p],A=rn[p],m=vr[p],w=_r[p];for(let B=0;B<16;B++){let _=H(r+$s(p,n,h,a)+Se[g[B]]+d,m[B])+l|0;r=l,l=a,a=H(h,10)|0,h=n,n=_}for(let B=0;B<16;B++){let _=H(o+$s(x,i,c,f)+Se[A[B]]+b,w[B])+u|0;o=u,u=f,f=H(c,10)|0,c=i,i=_}}this.set(this.h1+h+f|0,this.h2+a+u|0,this.h3+l+o|0,this.h4+r+i|0,this.h0+n+c|0)}roundClean(){L(Se)}destroy(){this.destroyed=!0,L(this.buffer),this.set(0,0,0,0,0)}},hn=ot(()=>new rs);var Sr=BigInt(0),ce=BigInt(1),Or=BigInt(2),Dr=BigInt(7),Cr=BigInt(256),Tr=BigInt(113),ln=[],fn=[],un=[];for(let e=0,t=ce,s=1,r=0;e<24;e++){[s,r]=[r,(2*s+3*r)%5],ln.push(2*(5*r+s)),fn.push((e+1)*(e+2)/2%64);let o=Sr;for(let n=0;n<7;n++)t=(t<<ce^(t>>Dr)*Tr)%Cr,t&Or&&(o^=ce<<(ce<<BigInt(n))-ce);un.push(o)}var dn=be(un,!0),Fr=dn[0],Mr=dn[1],cn=(e,t,s)=>s>32?ks(e,t,s):gs(e,t,s),an=(e,t,s)=>s>32?ms(e,t,s):ys(e,t,s);function Pr(e,t=24){let s=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)s[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let h=(i+8)%10,c=(i+2)%10,a=s[c],f=s[c+1],l=cn(a,f,1)^s[h],u=an(a,f,1)^s[h+1];for(let p=0;p<50;p+=10)e[i+p]^=l,e[i+p+1]^=u}let o=e[2],n=e[3];for(let i=0;i<24;i++){let h=fn[i],c=cn(o,n,h),a=an(o,n,h),f=ln[i];o=e[f],n=e[f+1],e[f]=c,e[f+1]=a}for(let i=0;i<50;i+=10){for(let h=0;h<10;h++)s[h]=e[i+h];for(let h=0;h<10;h++)e[i+h]^=~s[(h+2)%10]&s[(h+4)%10]}e[0]^=Fr[r],e[1]^=Mr[r]}L(s)}var lt=class e extends it{constructor(t,s,r,o=!1,n=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=s,this.outputLen=r,this.enableXOF=o,this.rounds=n,D(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=F(this.state)}clone(){return this._cloneInto()}keccak(){C(this.state32),Pr(this.state32,this.rounds),C(this.state32),this.posOut=0,this.pos=0}update(t){z(this),t=E(t),U(t);let{blockLen:s,state:r}=this,o=t.length;for(let n=0;n<o;){let i=Math.min(s-this.pos,o-n);for(let h=0;h<i;h++)r[this.pos++]^=t[n++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:s,pos:r,blockLen:o}=this;t[r]^=s,(s&128)!==0&&r===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){z(this,!1),U(t),this.finish();let s=this.state,{blockLen:r}=this;for(let o=0,n=t.length;o<n;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,n-o);t.set(s.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return D(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(ut(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,L(this.state)}_cloneInto(t){let{blockLen:s,suffix:r,outputLen:o,rounds:n,enableXOF:i}=this;return t||(t=new e(s,r,o,i,n)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=n,t.suffix=r,t.outputLen=o,t.enableXOF=i,t.destroyed=this.destroyed,t}},Pt=(e,t,s)=>ot(()=>new lt(t,e,s)),pn=Pt(6,144,224/8),xn=Pt(6,136,256/8),bn=Pt(6,104,384/8),gn=Pt(6,72,512/8),yn=Pt(1,144,224/8),kn=Pt(1,136,256/8),mn=Pt(1,104,384/8),wn=Pt(1,72,512/8),An=(e,t,s)=>Wt((r={})=>new lt(t,e,r.dkLen===void 0?s:r.dkLen,!0)),Bn=An(31,168,128/8),Ln=An(31,136,256/8);var Lt=BigInt(8),le=BigInt(255);function ae(e){e=BigInt(e);let t=[Number(e&le)];for(e>>=Lt;e>0;e>>=Lt)t.unshift(Number(e&le));return t.unshift(t.length),new Uint8Array(t)}function Nr(e){e=BigInt(e);let t=[Number(e&le)];for(e>>=Lt;e>0;e>>=Lt)t.unshift(Number(e&le));return t.push(t.length),new Uint8Array(t)}function De(e,t){return e.dkLen===void 0?t:e.dkLen}var os=e=>e===void 0?Uint8Array.of():E(e),In=(e,t)=>new Uint8Array((t-e%t)%t);function vn(e,t={}){if(!t||!t.personalization&&!t.NISTfn)return e;let s=ae(e.blockLen),r=os(t.NISTfn),o=ae(Lt*BigInt(r.length)),n=os(t.personalization),i=ae(Lt*BigInt(n.length));if(!r.length&&!n.length)return e;e.suffix=4,e.update(s).update(o).update(r).update(i).update(n);let h=s.length+o.length+r.length+i.length+n.length;return e.update(In(h,e.blockLen)),e}var _n=(e,t,s)=>Wt((r={})=>vn(new lt(t,e,De(r,s),!0),r)),Un=_n(31,168,128/8),En=_n(31,136,256/8),is=class extends lt{constructor(t,s,r,o,n={}){super(t,31,s,r),vn(this,{NISTfn:"KMAC",personalization:n.personalization}),o=E(o),U(o);let i=ae(this.blockLen),h=ae(Lt*BigInt(o.length));this.update(i).update(h).update(o);let c=i.length+h.length+o.length;this.update(In(c,this.blockLen))}finish(){this.finished||this.update(Nr(this.enableXOF?0:Lt*BigInt(this.outputLen))),super.finish()}_cloneInto(t){return t||(t=Object.create(Object.getPrototypeOf(this),{}),t.state=this.state.slice(),t.blockLen=this.blockLen,t.state32=F(t.state)),super._cloneInto(t)}clone(){return this._cloneInto()}};function Sn(e,t,s=!1){let r=(o,n,i)=>r.create(o,i).update(n).digest();return r.create=(o,n={})=>new is(e,De(n,t),s,o,n),r}var On=Sn(168,128/8),Dn=Sn(136,256/8);var Cn=(e,t)=>Wt((s={})=>{let r=s.D===void 0?31:s.D;if(!Number.isSafeInteger(r)||r<1||r>127)throw new Error("invalid domain separation byte must be 0x01..0x7f, got: "+r);return new lt(e,r,s.dkLen===void 0?t:s.dkLen,!0,12)}),Tn=Cn(168,256/8),Fn=Cn(136,512/8);function Hn(e){e=BigInt(e);let t=[];for(;e>0;e>>=Lt)t.unshift(Number(e&le));return t.push(t.length),Uint8Array.from(t)}var Gr=Uint8Array.of(),Oe=class e extends lt{constructor(t,s,r,o,n){super(t,7,r,!0,o),this.chunkLen=8192,this.chunkPos=0,this.chunksDone=0,this.leafLen=s,this.personalization=os(n.personalization)}update(t){t=E(t),U(t);let{chunkLen:s,blockLen:r,leafLen:o,rounds:n}=this;for(let i=0,h=t.length;i<h;){this.chunkPos==s&&(this.leafHash?super.update(this.leafHash.digest()):(this.suffix=6,super.update(Uint8Array.from([3,0,0,0,0,0,0,0]))),this.leafHash=new lt(r,11,o,!1,n),this.chunksDone++,this.chunkPos=0);let c=Math.min(s-this.chunkPos,h-i),a=t.subarray(i,i+c);this.leafHash?this.leafHash.update(a):super.update(a),this.chunkPos+=c,i+=c}return this}finish(){if(this.finished)return;let{personalization:t}=this;this.update(t).update(Hn(t.length)),this.leafHash&&(super.update(this.leafHash.digest()),super.update(Hn(this.chunksDone)),super.update(Uint8Array.from([255,255]))),super.finish.call(this)}destroy(){super.destroy.call(this),this.leafHash&&this.leafHash.destroy(),this.personalization=Gr}_cloneInto(t){let{blockLen:s,leafLen:r,leafHash:o,outputLen:n,rounds:i}=this;return t||(t=new e(s,r,n,i,{})),super._cloneInto(t),o&&(t.leafHash=o._cloneInto(t.leafHash)),t.personalization.set(this.personalization),t.leafLen=this.leafLen,t.chunkPos=this.chunkPos,t.chunksDone=this.chunksDone,t}clone(){return this._cloneInto()}},Mn=ct((e={})=>new Oe(168,32,De(e,32),12,e)),Pn=ct((e={})=>new Oe(136,64,De(e,64),14,e)),hs=class e extends lt{constructor(t){if(D(t),t<0||t>1590||(1600-t-2)%8)throw new Error("invalid capacity");super((1600-t-2)/8,0,0,!0),this.rate=1600-t,this.posOut=Math.floor((this.rate+7)/8)}keccak(){this.state[this.pos]^=1,this.state[this.blockLen]^=2,super.keccak(),this.pos=0,this.posOut=0}update(t){return super.update(t),this.posOut=this.blockLen,this}feed(t){return this.update(t)}finish(){}digestInto(t){throw new Error("digest is not allowed, use .fetch instead")}fetch(t){return this.xof(t)}forget(){if(this.rate<1600/2+1)throw new Error("rate is too low to use .forget()");this.keccak();for(let t=0;t<this.blockLen;t++)this.state[t]=0;this.pos=this.blockLen,this.keccak(),this.posOut=this.blockLen}_cloneInto(t){let{rate:s}=this;return t||(t=new e(1600-s)),super._cloneInto(t),t.rate=s,t}clone(){return this._cloneInto()}},Nn=(e=254)=>new hs(e);var Rr={bytesToHex:fe,hexToBytes:ue,concatBytes:ps,utf8ToBytes:de,randomBytes:xs};return Kn(Xr);})();
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
